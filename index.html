<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>IdeaFlow</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
--bg:#020617;
--card:#0f172a;
--border:#1e293b;
--text:#e5e7eb;
--muted:#94a3b8;
--primary:#2563eb;
--green:#16a34a;
--yellow:#ca8a04;
--red:#dc2626;
}

*{box-sizing:border-box}

body{
margin:0;
font-family:system-ui, sans-serif;
background:var(--bg);
color:var(--text);
display:flex;
min-height:100vh;
}

/* SIDEBAR */
.sidebar{
width:260px;
padding:20px;
border-right:1px solid var(--border);
}

.sidebar input{
width:100%;
padding:12px;
border-radius:12px;
border:1px solid var(--border);
background:#020617;
color:var(--text);
}

/* MAIN */
.main{
flex:1;
padding:30px;
}

.idea-box{
background:var(--card);
border:1px solid var(--border);
border-radius:18px;
padding:24px;
margin:20px 0;
}

textarea,input,select{
width:100%;
padding:12px;
margin-top:10px;
border-radius:12px;
border:1px solid var(--border);
background:#020617;
color:var(--text);
}

button{
margin-top:14px;
width:100%;
padding:14px;
border:none;
border-radius:14px;
background:var(--primary);
color:white;
font-weight:600;
cursor:pointer;
}

.idea-card{
background:var(--card);
border:1px solid var(--border);
border-radius:16px;
padding:16px;
margin-bottom:14px;
display:flex;
flex-direction:column;
gap:10px;
}

.badge{
font-size:.7rem;
padding:4px 8px;
border-radius:999px;
margin-right:6px;
display:inline-block;
}

.status-idea{background:#334155}
.status-progress{background:var(--yellow)}
.status-done{background:var(--green)}

.prio-low{background:#334155}
.prio-mid{background:#2563eb}
.prio-high{background:var(--red)}

.tag{
background:#1e40af;
}

.actions{
display:flex;
justify-content:space-between;
align-items:center;
}

.actions button{
background:none;
border:none;
cursor:pointer;
color:var(--muted);
font-size:1.1rem;
width:auto;
}
</style>
</head>

<body>

<aside class="sidebar">
<h2>ğŸ” Pesquisa</h2>
<input id="searchInput" placeholder="Texto ou #tag" oninput="renderIdeas()">
</aside>

<main class="main">
<h1>IdeaFlow</h1>
<p style="color:var(--muted)">Organize, evolua e priorize ideias</p>

<div class="idea-box">
<h2>ğŸ’¡ Nova ideia</h2>

<textarea id="ideaInput" placeholder="Descreva a ideia"></textarea>
<input id="tagsInput" placeholder="Tags (ex: app, IA, marketing)">
<select id="statusInput">
<option value="idea">Ideia</option>
<option value="progress">Em progresso</option>
<option value="done">Finalizada</option>
</select>
<select id="priorityInput">
<option value="low">Prioridade baixa</option>
<option value="mid">Prioridade mÃ©dia</option>
<option value="high">Prioridade alta</option>
</select>

<button onclick="addIdea()">Salvar</button>
</div>

<div id="ideasList"></div>
</main>

<script>
const currentUser = localStorage.getItem("currentUser");
if(!currentUser) location.href="login.html";

const users = JSON.parse(localStorage.getItem("users")) || {};
let ideas = users[currentUser]?.ideas || [];

function save(){
users[currentUser].ideas = ideas;
localStorage.setItem("users", JSON.stringify(users));
}

function addIdea(){
if(!ideaInput.value.trim()) return alert("Digite a ideia");

ideas.unshift({
id:Date.now(),
content:ideaInput.value.trim(),
tags: tagsInput.value
  .split(",")
  .map(t=>t.trim().toLowerCase())
  .filter(Boolean),
status:statusInput.value,
priority:priorityInput.value,
pinned:false,
created:new Date().toLocaleString()
});

ideaInput.value="";
tagsInput.value="";
save();
renderIdeas();
}

function togglePin(id){
const idea = ideas.find(i=>i.id===id);
idea.pinned = !idea.pinned;
save();
renderIdeas();
}

function changeStatus(id){
const idea = ideas.find(i=>i.id===id);
const s = prompt("Status: idea / progress / done", idea.status);
if(!s) return;
idea.status=s;
save();
renderIdeas();
}

function deleteIdea(id){
ideas = ideas.filter(i=>i.id!==id);
save();
renderIdeas();
}

function renderIdeas(){
const q = searchInput.value.toLowerCase();
const list = document.getElementById("ideasList");
list.innerHTML="";

let filtered = ideas.filter(i=>{
const textMatch = i.content.toLowerCase().includes(q);
const tagMatch = i.tags.some(t => t.includes(q.replace("#","")));
return textMatch || tagMatch;
});

let sorted = filtered.sort((a,b)=>{
if(a.pinned!==b.pinned) return b.pinned - a.pinned;
const p={high:3,mid:2,low:1};
return p[b.priority]-p[a.priority];
});

if(!sorted.length){
list.innerHTML="<p style='color:#94a3b8'>Nenhuma ideia encontrada</p>";
return;
}

sorted.forEach(i=>{
list.innerHTML+=`
<div class="idea-card">
<strong>${i.pinned?"ğŸ“Œ ":""}${i.content}</strong>

<div>
<span class="badge status-${i.status}">${i.status}</span>
<span class="badge prio-${i.priority}">${i.priority}</span>
</div>

<div>
${i.tags.map(t=>`<span class="badge tag">#${t}</span>`).join("")}
</div>

<small>${i.created}</small>

<div class="actions">
<div>
<button onclick="togglePin(${i.id})">ğŸ“Œ</button>
<button onclick="changeStatus(${i.id})">ğŸ”„</button>
</div>
<button onclick="deleteIdea(${i.id})">ğŸ—‘ï¸</button>
</div>
</div>`;
});
}

renderIdeas();
</script>
</body>
</html>
